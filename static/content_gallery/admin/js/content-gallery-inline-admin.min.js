(function(a){window.ContentGallery=window.ContentGallery||{};galleryAdminView=ContentGallery.galleryAdminView;a(function(){a(".content-gallery-images-container").sortable({cursor:"move",revert:200,tolerance:"pointer",connectWith:".content-gallery-images-container",handle:".content-gallery-image-header",items:"> :not(.content-gallery-add-new-image)",placeholder:"content-gallery-placeholder",update:function(b,c){a("#content-gallery-sorted-images").find(".content-gallery-image-position").each(function(d){a(this).val(d)});a("#content-gallery-sorted-images").find(".content-gallery-image-delete").find("input").removeAttr("value");a("#content-gallery-images-to-delete").find(".content-gallery-image-delete").find("input").val(1)}});a("#id_image").on("change",function(){var c=this.value;var i=a(".content-gallery-images");var j=i.attr("data-inline-formset");var b=JSON.parse(j);var d=b.options.prefix;var h=i.find("#id_"+d+"-TOTAL_FORMS");var g=h.val();var e=parseInt(g)+1;var f=d+"-"+g;h.val(e);i.find("#id_"+d+"-INITIAL_FORMS").val(e);var k=i.attr("data-preview-url-pattern")+c;a.ajax({url:k,dataType:"json",beforeSend:function(l){if(l.overrideMimeType){l.overrideMimeType("application/json")}},success:function(l){a("#content-gallery-sorted-images").find(".content-gallery-add-new-image").before(a("<div></div>").addClass("content-gallery-image-object").append(a("<div></div>").addClass("content-gallery-image-header")).append(a("<div></div>").addClass("content-gallery-image-content").append(a("<span></span>").addClass("content-gallery-image-delete").append(a("<input>").attr("type","hidden").attr("id","id_"+f+"-DELETE").attr("name",f+"-DELETE"))).append(a("<span></span>").addClass("content-gallery-preview-container").append(a("<a></a>").addClass("content-gallery-image-content-link").addClass("content-gallery-open-view").addClass("content-gallery-block-box").addClass("content-gallery-centered-image").attr("href","#").attr("data-image",l.image_data).append(a("<img>").addClass("content-gallery-image-preview").attr("src",l.small_preview_url))).append(a("<img>").addClass("content-gallery-zoom").addClass("content-gallery-inline-preview-zoom").attr("src",l.zoom_url))).append(a("<input>").addClass("content-gallery-image-position").attr("type","hidden").attr("id","id_"+f+"-position").attr("name",f+"-position").val(l.position)).append(a("<input>").attr("type","hidden").attr("id","id_"+f+"-id").attr("name",f+"-id").val(c))))}})})})})(django.jQuery);